import{d as G,j as H,r as C,a as n,c as J,b as e,w as t,F as Q,o as W,g as d,e as c,t as p,u as h,n as X,E as x,x as Z,y as k,s as ee,p as te,f as le,_ as oe}from"./index-Xpy_FskK.js";import{h as ne,i as D,j as ae}from"./index-pTBkHeYb.js";const se=f=>(te("data-v-5a0f4c14"),f=f(),le(),f),ce={class:"card_head"},re={class:"card_body"},ie={class:"card_bottom"},de=["id"],ue={class:"cell-item"},pe={class:"cell-item"},_e={class:"cell-item"},me={class:"cell-item"},ve={class:"cell-item"},fe=se(()=>d("h4",null,"菜品详情",-1)),ge=G({__name:"OrderView",setup(f){H(()=>{_()});const r=C({records:[],total:20,current:1,size:10}),u=C({oid:"",date:[]}),s=C({visible:!1,title:"订单详情",order:{},detail:[]}),V=["已支付","已出餐","已完成","已退单"],z=async o=>{console.log(o),x.confirm("确认出餐吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log("确定"),D(o.id,1),_()}).catch(()=>{console.log("取消")})},T=async o=>{console.log(o),s.value.visible=!0,s.value.title="订单详情",s.value.order=o;const l=await ae(o.id);s.value.detail=l,console.log(s.value.detail)},S=async o=>{console.log(o),x.confirm("确认退单吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{console.log("确定"),D(o.id,3),_()}).catch(()=>{console.log("取消")})},_=async()=>{console.log("refresh");const o=u.value,l=await ne(r.value.current,r.value.size,o.oid,o.date[0],o.date[1]);console.log(l),r.value=l},B=async()=>{console.log(u.value.date),_()},M=o=>{console.log(`current page: ${o}`),r.value.current=o,_()},Y=()=>{console.log(u.value.oid),_()},O=[{text:"最近一周",value:()=>{const o=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*7),[l,o]}},{text:"最近一个月",value:()=>{const o=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*30),[l,o]}},{text:"最近三个月",value:()=>{const o=new Date,l=new Date;return l.setTime(l.getTime()-3600*1e3*24*90),[l,o]}}];return(o,l)=>{const I=n("el-input"),y=n("el-col"),U=n("el-date-picker"),g=n("el-button"),$=n("el-row"),i=n("el-table-column"),j=n("el-button-group"),w=n("el-table"),E=n("el-pagination"),F=n("el-card"),N=n("user"),m=n("el-icon"),v=n("el-descriptions-item"),L=n("iphone"),q=n("Money"),K=n("office-building"),P=n("el-descriptions"),R=n("el-divider"),A=n("el-drawer");return W(),J(Q,null,[e(F,{class:"card"},{default:t(()=>[d("div",ce,[e($,{gutter:20},{default:t(()=>[e(y,{span:4},{default:t(()=>[e(I,{size:"large","prefix-icon":"Search",autocomlpete:"off",placeholder:"请输入订单号",modelValue:u.value.oid,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value.oid=a),onInput:Y},null,8,["modelValue"])]),_:1}),e(y,{span:8},{default:t(()=>[e(U,{size:"large",type:"daterange","unlink-panels":"","range-separator":"To","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY/MM/DD","value-format":"YYYY-MM-DD",shortcuts:O,modelValue:u.value.date,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value.date=a),onChange:B},null,8,["modelValue"])]),_:1}),e(y,{span:4},{default:t(()=>[e(g,{icon:"Search",size:"large",type:"primary"},{default:t(()=>[c("搜索")]),_:1})]),_:1})]),_:1})]),d("div",re,[e(w,{data:r.value.records,style:{width:"100%"},border:""},{default:t(()=>[e(i,{prop:"id",label:"订单号"}),e(i,{prop:"user.username",label:"用户"}),e(i,{prop:"create_time",label:"下单时间"}),e(i,{prop:"status",label:"订单状态"},{default:t(({row:a})=>[c(p(V[a.status]),1)]),_:1}),e(i,{label:"操作"},{default:t(({row:a})=>[e(j,null,{default:t(()=>[e(g,{circle:"",plain:"",type:"primary",icon:h(Z),onClick:b=>z(a)},null,8,["icon","onClick"]),e(g,{circle:"",plain:"",type:"warning",icon:h(k),onClick:b=>T(a)},null,8,["icon","onClick"]),e(g,{circle:"",plain:"",type:"danger",icon:h(ee),onClick:b=>S(a)},null,8,["icon","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),d("div",ie,[e(E,{"current-page":r.value.current,"onUpdate:currentPage":l[2]||(l[2]=a=>r.value.current=a),"page-size":r.value.size,"onUpdate:pageSize":l[3]||(l[3]=a=>r.value.size=a),layout:"total, prev, pager, next, jumper",total:r.value.total,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1}),e(A,{size:"50%",modelValue:s.value.visible,"onUpdate:modelValue":l[4]||(l[4]=a=>s.value.visible=a),"show-close":!0},{header:t(({titleId:a,titleClass:b})=>[d("h4",{id:a,class:X(b)},p(s.value.title),11,de)]),default:t(()=>[e(P,{class:"margin-top",title:"用户信息",column:2,border:""},{default:t(()=>[e(v,null,{label:t(()=>[d("div",ue,[e(m,null,{default:t(()=>[e(N)]),_:1}),c(" 用户名 ")])]),default:t(()=>[c(" "+p(s.value.order.user.username),1)]),_:1}),e(v,null,{label:t(()=>[d("div",pe,[e(m,null,{default:t(()=>[e(L)]),_:1}),c(" 电话 ")])]),default:t(()=>[c(" "+p(s.value.order.user.phone),1)]),_:1}),e(v,null,{label:t(()=>[d("div",_e,[e(m,null,{default:t(()=>[e(q)]),_:1}),c(" 总价 ")])]),default:t(()=>[c(" "+p(s.value.order.totalprice)+"元 ",1)]),_:1}),e(v,null,{label:t(()=>[d("div",me,[e(m,null,{default:t(()=>[e(K)]),_:1}),c(" 地址 ")])]),default:t(()=>[c(" "+p(s.value.order.address.detail),1)]),_:1}),e(v,null,{label:t(()=>[d("div",ve,[e(m,null,{default:t(()=>[e(h(k))]),_:1}),c(" 备注 ")])]),default:t(()=>[c(" "+p(s.value.order.comment),1)]),_:1})]),_:1}),e(R),fe,e(w,{data:s.value.detail,border:""},{default:t(()=>[e(i,{prop:"id",label:"id"}),e(i,{prop:"dish.name",label:"菜品"}),e(i,{prop:"quantity",label:"数量"}),e(i,{prop:"price",label:"价格"}),e(i,{prop:"mark",label:"评分"})]),_:1},8,["data"])]),_:1},8,["modelValue"])],64)}}}),ye=oe(ge,[["__scopeId","data-v-5a0f4c14"]]);export{ye as default};
